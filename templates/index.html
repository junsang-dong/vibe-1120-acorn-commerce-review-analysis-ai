<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>쿠팡 리뷰 감정 분석 챗봇</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>🛒 아마존 리뷰 감정 분석</h1>
            <p class="subtitle">상품 리뷰를 AI로 분석하여 감정을 파악합니다</p>
        </header>

        <main>
            <div class="input-section">
                <div class="input-group">
                    <label for="productInput">아마존 상품 URL 입력</label>
                    <input 
                        type="text" 
                        id="productInput" 
                        placeholder="예: https://www.amazon.com/dp/B0F7J243YH..."
                        class="product-input"
                    >
                    <button id="getInfoBtn" class="analyze-btn">
                        <span class="btn-text">상품 정보 조회</span>
                        <span class="btn-loading" style="display: none;">
                            <span class="spinner"></span> 조회 중...
                        </span>
                    </button>
                </div>
                <p class="help-text">
                    💡 예시: https://www.amazon.com/Samsung-Smartphone-Unlocked-Manufacturer-Warranty/dp/B0F7J243YH
                </p>
            </div>

            <div id="loadingSection" class="loading-section" style="display: none;">
                <div class="loading-spinner"></div>
                <p id="loadingText">상품 정보를 조회하는 중입니다...</p>
            </div>

            <div id="errorSection" class="error-section" style="display: none;">
                <div class="error-icon">⚠️</div>
                <p id="errorMessage"></p>
            </div>

            <!-- 1단계: 상품 기본 정보 -->
            <div id="productInfoSection" class="product-info-section" style="display: none;">
                <h2>📦 상품 기본 정보</h2>
                <div class="product-info-grid">
                    <div class="info-card">
                        <h3>상품명</h3>
                        <p id="productName">-</p>
                    </div>
                    <div class="info-card">
                        <h3>전체 리뷰 수</h3>
                        <p id="totalReviews">-</p>
                    </div>
                    <div class="info-card">
                        <h3>평균 평점</h3>
                        <p id="avgRating">-</p>
                    </div>
                    <div class="info-card">
                        <h3>긍정 리뷰 비중</h3>
                        <p id="positiveRatio">-</p>
                    </div>
                    <div class="info-card">
                        <h3>부정 리뷰 비중</h3>
                        <p id="negativeRatio">-</p>
                    </div>
                </div>
                
                <div class="similar-products-container">
                    <h3>🔍 경쟁 제품</h3>
                    <div id="similarProducts" class="similar-products-list">
                    </div>
                </div>
                
                <div class="action-section">
                    <button id="analyzeReviewsBtn" class="analyze-btn">
                        <span class="btn-text">리뷰 모아보기</span>
                        <span class="btn-loading" style="display: none;">
                            <span class="spinner"></span> 수집 중...
                        </span>
                    </button>
                </div>
                
                <!-- 리뷰 표시 영역 -->
                <div id="reviewsDisplaySection" class="reviews-display-section" style="display: none;">
                    <div class="reviews-header">
                        <h3>📝 최신 리뷰 목록 (10개)</h3>
                        <button id="exportCsvBtn" class="export-btn">
                            📊 CSV 내보내기
                        </button>
                    </div>
                    <div class="table-container">
                        <table id="reviewsTable" class="reviews-table">
                            <thead>
                                <tr>
                                    <th>번호</th>
                                    <th>평점</th>
                                    <th>감정</th>
                                    <th>리뷰 내용</th>
                                </tr>
                            </thead>
                            <tbody id="reviewsTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- 2단계: 리뷰 분석 결과 -->
            <div id="resultsSection" class="results-section" style="display: none;">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon positive-icon">😊</div>
                        <div class="stat-number" id="positiveCount">0</div>
                        <div class="stat-label">긍정</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon neutral-icon">😐</div>
                        <div class="stat-number" id="neutralCount">0</div>
                        <div class="stat-label">중립</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon negative-icon">😞</div>
                        <div class="stat-number" id="negativeCount">0</div>
                        <div class="stat-label">부정</div>
                    </div>
                </div>

                <div class="chart-container">
                    <h2>감정 분석 결과</h2>
                    <canvas id="sentimentChart"></canvas>
                </div>

                <div class="summary-container">
                    <h2>📊 AI 종합 분석 리포트</h2>
                    <div class="summary-content" id="summaryContent">
                        분석 결과를 생성하는 중...
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>Powered by GPT API & BeautifulSoup | Amazon Review Analysis | Made with ❤️</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>

